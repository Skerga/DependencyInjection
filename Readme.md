# Godot Dependency Injection

This project brings a small Source-generator that enables Dependency Injection in Godot.
Any Godot Node with a Constructer decorated with the `ÃŒnject` attribute will have a public parameterless
constructor created by the Sourcegenerator that chains the user defined constructor, and adds its Dependencies.

### Disclaimer
This Project is still heavely under development, its functional but should not be used as is for production use without carefull consideration.

This Node:
```
public partial class Main : Node
{
    private readonly ILogger<Main> _logger;

    [Inject]
    public Main(ILogger<Main> logger)
    {
        _logger = logger;
    }

    public override void _Ready()
    {
        _logger.LogInformation("Hello World!");
    }
}
```
will generate the following code to satisfy Godots requirement of a parameterless public constructor
```
// <auto-generated/>
public partial class Main
{
   public Main() : this(global::Godot.DependencyInjection.DependencyInjection.GetService<Microsoft.Extensions.Logging.ILogger<Main>>())
   {} 
};
```

Services can be registered by adding the following code:

```
namespace Godot.DependencyInjection
{
    internal partial class DependencyInjection
    {
        static partial void ConfigureHostConfiguration(IConfigurationBuilder configurationBuilder)
        {
            // ...
        }

        static partial void ConfigureServices(HostBuilderContext context, IServiceCollection services)
        {
            services.AddLogging(configure => configure.AddConsole());
            // ...
        }
    }
};
```

`HostedServices` are possible and if not wanted to be run in the Editor should be guarded with Godots `Engine.IsEditorHint()`.

If a service with the basetype of Node is registered, either by using `services.AddSingleton<MyNode>():` or `services.AddHostedService<MyNode>();`
then this Node will be added to the `SceneTree` as a child of the `DependencyInjection` Node.

## Licence
This project is licensed under the MIT License. See the [LICENSE](https://github.com/Skerga/Godot.DependencyInjection/blob/main/LICENSE) file for more information.